---
title: CVE-2024-12905 - tar-fs Vulnerability Ananlysis and PoC
date: 2025-04-18 09:00:00 +0800
categories: [Vulnerability Research, Exploit Development]
tags: [arbitrary file write, file overwrite, link following]
math: true
mermaid: true
media_subpath: /assets/posts/2025-04-18-tarFs-PoC
image:
  path: preview.png
---

# Vulnerability anaylsis and PoC Development for CVE-2024-12905

## Introduction     
The `tar-fs` npm package is commonly used in JavaScript projects to pack and extract `.tar` archive files. However, a critical vulnerability ([CVE-2024-12905](https://github.com/advisories/GHSA-pq67-2wwv-3xjx)) affects several versions of this package — specifically:

- Versions from 0.0.0 before 1.16.4

- Versions from 2.0.0 before 2.1.2

- Versions from 3.0.0 before 3.0.7

This vulnerability allows attackers to craft malicious `.tar` archives that can write or overwrite files outside the intended extraction directory, potentially leading to arbitrary file write attacks. This kind of flaw poses a serious risk, especially in environments that automatically extract user-provided archives.

In this blog, we’ll dive into the `tar-fs` source code and analyze the relevant Git commits before and after the patch to understand how the vulnerability works. We'll also walk through the process of crafting a proof-of-concept (PoC) exploit to demonstrate its impact.

## Vulnerability Analysis

## Exploit Development

## Testing The Exploit

### References